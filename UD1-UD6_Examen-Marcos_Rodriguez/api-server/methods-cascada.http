### ============================================================================
### API REST VETERINARIA - PRUEBAS EN CASCADA
### ============================================================================
### URL Base: http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public
### Autenticación Basic Auth: dwes:dwes (Base64: ZHdlczpkd2Vz)
### ============================================================================

### ============================================================================
### 1. LOGIN - Iniciar sesión como veterinario
### ============================================================================
POST http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladorauth/login
Content-Type: application/json
Authorization: Basic ZHdlczpkd2Vz

{
  "email": "garcia@vet.com",
  "clave": "1234"
}

### Respuesta esperada:
### {
###   "success": true,
###   "message": "Login exitoso",
###   "veterinario": {
###     "id": "1",
###     "email": "garcia@vet.com",
###     "nombre": "Dr. García"
###   }
### }

### ============================================================================
### 2. VERIFICAR SESIÓN - Comprobar que el login fue exitoso
### ============================================================================
GET http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladorauth/verificar
Authorization: Basic ZHdlczpkd2Vz

### Respuesta esperada:
### {
###   "autenticado": true,
###   "veterinario": {
###     "id": "1",
###     "email": "garcia@vet.com",
###     "nombre": "Dr. García"
###   }
### }

### ============================================================================
### 3. LISTAR TODAS LAS MASCOTAS - Ver las mascotas existentes en la BD
### ============================================================================
GET http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/mascotas
Authorization: Basic ZHdlczpkd2Vz

### Respuesta esperada:
### {
###   "success": true,
###   "mascotas": [
###     {
###       "id": "1",
###       "nombre": "Rallito",
###       "tipo": "tortuga",
###       "fecha_nacimiento": "2015-09-21",
###       "foto_url": "/public/img/tortuga.jpeg",
###       "id_persona": "1"
###     },
###     ...
###   ]
### }
### NOTA: Copia uno de los IDs de mascota para los siguientes pasos

### ============================================================================
### 4. OBTENER UNA MASCOTA ESPECÍFICA - Consultar detalles de una mascota
### ============================================================================
GET http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/mascota/1
Authorization: Basic ZHdlczpkd2Vz

### Respuesta esperada:
### {
###   "success": true,
###   "mascota": {
###     "id": "1",
###     "nombre": "Rallito",
###     "tipo": "tortuga",
###     "fecha_nacimiento": "2015-09-21",
###     "foto_url": "/public/img/tortuga.jpeg",
###     "id_persona": "1"
###   }
### }

### ============================================================================
### 5. CREAR NUEVA MASCOTA - Registrar una nueva mascota en el sistema
### ============================================================================
POST http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/crear
Content-Type: application/json
Authorization: Basic ZHdlczpkd2Vz

{
  "nombre": "Firulais",
  "tipo": "perro",
  "fechaNac": "2022-05-15",
  "fotoUrl": "/public/img/perro.jpeg",
  "idPers": "1"
}

### Respuesta esperada:
### {
###   "success": true,
###   "message": "Mascota creada",
###   "mascota": {
###     "id": "uuid-generado",
###     "nombre": "Firulais",
###     "tipo": "perro",
###     "fecha_nacimiento": "2022-05-15",
###     "foto_url": "/public/img/perro.jpeg",
###     "id_persona": "1"
###   }
### }
### IMPORTANTE: Copia el ID generado de la respuesta para los siguientes pasos

### ============================================================================
### 6. ACTUALIZAR MASCOTA - Modificar los datos de la mascota recién creada
### ============================================================================
### NOTA: Reemplaza el ID en la URL con el UUID obtenido en el paso anterior
PUT http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/actualizar/1edda29c-8935-40d7-b2f8-9ba02af00635
Content-Type: application/json
Authorization: Basic ZHdlczpkd2Vz

{
  "nombre": "Firulais Actualizado",
  "tipo": "perro labrador",
  "fechaNac": "2022-05-15",
  "fotoUrl": "/public/img/perro_labrador.jpeg",
  "idPers": "1"
}

### Respuesta esperada:
### {
###   "success": true,
###   "message": "Mascota actualizada"
### }

### ============================================================================
### 7. VERIFICAR ACTUALIZACIÓN - Comprobar que los cambios se guardaron
### ============================================================================
### NOTA: Reemplaza el ID con el mismo UUID del paso anterior
GET http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/mascota/1edda29c-8935-40d7-b2f8-9ba02af00635
Authorization: Basic ZHdlczpkd2Vz

### Respuesta esperada: Debería mostrar los datos actualizados
### {
###   "success": true,
###   "mascota": {
###     "id": "uuid",
###     "nombre": "Firulais Actualizado",
###     "tipo": "perro labrador",
###     ...
###   }
### }

### ============================================================================
### 8. LISTAR MASCOTAS ACTUALIZADO - Ver todas las mascotas incluyendo la nueva
### ============================================================================
GET http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/mascotas
Authorization: Basic ZHdlczpkd2Vz

### Respuesta esperada: Lista completa con la nueva mascota incluida

### ============================================================================
### 9. ELIMINAR MASCOTA - Borrar la mascota de prueba creada
### ============================================================================
### NOTA: Reemplaza el ID con el UUID de la mascota creada en el paso 5
DELETE http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/eliminar/1edda29c-8935-40d7-b2f8-9ba02af00635
Authorization: Basic ZHdlczpkd2Vz

### Respuesta esperada:
### {
###   "success": true,
###   "message": "Mascota eliminada"
### }

### ============================================================================
### 10. VERIFICAR ELIMINACIÓN - Comprobar que la mascota fue eliminada
### ============================================================================
GET http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/mascotas
Authorization: Basic ZHdlczpkd2Vz

### Respuesta esperada: Lista sin la mascota eliminada (vuelve a las 3 originales)

### ============================================================================
### 11. CREAR MÚLTIPLES MASCOTAS - Registrar varias mascotas para pruebas
### ============================================================================

### Mascota 1: Gato
POST http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/crear
Content-Type: application/json
Authorization: Basic ZHdlczpkd2Vz

{
  "nombre": "Michi",
  "tipo": "gato",
  "fechaNac": "2021-03-10",
  "fotoUrl": "/public/img/gato2.jpeg",
  "idPers": "2"
}

###

### Mascota 2: Hamster
POST http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/crear
Content-Type: application/json
Authorization: Basic ZHdlczpkd2Vz

{
  "nombre": "Pelusa",
  "tipo": "hamster",
  "fechaNac": "2023-11-22",
  "fotoUrl": "/public/img/hamster.jpeg",
  "idPers": "2"
}

###

### Mascota 3: Conejo
POST http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/crear
Content-Type: application/json
Authorization: Basic ZHdlczpkd2Vz

{
  "nombre": "Copito",
  "tipo": "conejo",
  "fechaNac": "2023-01-05",
  "fotoUrl": "/public/img/conejo.jpeg",
  "idPers": "1"
}

### ============================================================================
### 12. LISTAR TODAS LAS MASCOTAS - Ver el listado completo actualizado
### ============================================================================
GET http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/mascotas
Authorization: Basic ZHdlczpkd2Vz

### Respuesta esperada: Lista con todas las mascotas (originales + las 3 nuevas)

### ============================================================================
### 13. LOGOUT - Cerrar sesión del veterinario
### ============================================================================
POST http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladorauth/logout
Authorization: Basic ZHdlczpkd2Vz

### Respuesta esperada:
### {
###   "success": true,
###   "message": "Sesión cerrada"
### }

### ============================================================================
### 14. VERIFICAR SESIÓN DESPUÉS DE LOGOUT - Confirmar que la sesión se cerró
### ============================================================================
GET http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladorauth/verificar
Authorization: Basic ZHdlczpkd2Vz

### Respuesta esperada:
### {
###   "autenticado": false
### }

### ============================================================================
### PRUEBAS DE ERRORES Y VALIDACIONES
### ============================================================================

### ERROR 1: Sin Basic Auth - Debe devolver 401 Unauthorized
GET http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/mascotas

### Respuesta esperada: 401 {"error": "Unauthorized"}

###

### ERROR 2: Basic Auth Incorrecto - Credenciales incorrectas
GET http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/mascotas
Authorization: Basic aW5jb3JyZWN0bzppbmNvcnJlY3Rv

### Respuesta esperada: 401 {"error": "Unauthorized"}

###

### ERROR 3: Login con credenciales incorrectas
POST http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladorauth/login
Content-Type: application/json
Authorization: Basic ZHdlczpkd2Vz

{
  "email": "noexiste@vet.com",
  "clave": "mala"
}

### Respuesta esperada: 401 {"error": "Credenciales inválidas"}

###

### ERROR 4: Mascota inexistente - ID que no existe
GET http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/mascota/id-que-no-existe-999
Authorization: Basic ZHdlczpkd2Vz

### Respuesta esperada: 404 {"error": "Mascota no encontrada"}

###

### ERROR 5: Crear mascota sin campo requerido (sin nombre)
POST http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/crear
Content-Type: application/json
Authorization: Basic ZHdlczpkd2Vz

{
  "tipo": "perro",
  "fechaNac": "2022-05-15",
  "fotoUrl": "/public/img/perro.jpeg",
  "idPers": "1"
}

### Respuesta esperada: 400 {"error": "Campo nombre requerido"}

###

### ERROR 6: Actualizar mascota inexistente
PUT http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/actualizar/id-que-no-existe-999
Content-Type: application/json
Authorization: Basic ZHdlczpkd2Vz

{
  "nombre": "Test",
  "tipo": "test",
  "fechaNac": "2022-01-01",
  "fotoUrl": "/test.jpg",
  "idPers": "1"
}

### Respuesta esperada: 404 {"error": "Mascota no encontrada"}

###

### ERROR 7: Método no permitido (GET en lugar de POST para crear)
GET http://mywww/UD1-UD6_Examen-Marcos_Rodriguez/api-server/public/controladormascotas/crear
Authorization: Basic ZHdlczpkd2Vz

### Respuesta esperada: 405 {"error": "Method not allowed"}

### ============================================================================
### FIN DE LAS PRUEBAS EN CASCADA
### ============================================================================
